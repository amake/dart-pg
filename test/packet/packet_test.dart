import 'dart:convert';

import 'package:dart_pg/src/packet/image_attribute.dart';
import 'package:dart_pg/src/packet/user_attribute.dart';
import 'package:dart_pg/src/packet/user_attribute_subpacket.dart';
import 'package:dart_pg/src/packet/user_id.dart';
import 'package:faker/faker.dart';
import 'package:test/test.dart';

void main() {
  group('packet tests', (() {
    final faker = Faker();
    test('user id test', (() {
      final name = faker.person.name();
      final email = faker.internet.email();
      final comment = faker.lorem.words(3).join(' ');

      final userId = UserID(name, email, comment: comment);
      expect(userId.name, name);
      expect(userId.email, email);
      expect(userId.comment, comment);

      final cloneUserId = UserID.fromPacketData(userId.toPacketData());
      expect(userId.name, cloneUserId.name);
      expect(userId.email, cloneUserId.email);
      expect(userId.comment, cloneUserId.comment);
    }));

    test('user attribute test', (() {
      final jpegImg = r'''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
IFeH/9k=''';

      final imageData = base64.decode(LineSplitter().convert(jpegImg).join());
      final subpacketType = faker.randomGenerator.integer(100);
      final subpacketData = utf8.encoder.convert(faker.lorem.words(100).join(' '));

      final userAttr = UserAttribute.fromPacketData(UserAttribute([
        ImageAttribute.fromImageData(imageData),
        UserAttributeSubpacket(subpacketType, subpacketData),
      ]).toPacketData());
      final imageAttr = userAttr.attributes[0] as ImageAttribute;
      final subpacket = userAttr.attributes[1];

      expect(imageAttr.version, 0x01);
      expect(imageAttr.encoding, ImageAttribute.jpeg);
      expect(imageAttr.imageData, imageData);

      expect(subpacket.type, subpacketType);
      expect(subpacket.data, subpacketData);
    }));

    test('signature packet test', (() {}));
  }));
}
